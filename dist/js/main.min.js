document.addEventListener("DOMContentLoaded",function(){function e(e,t,n,r,a){this.name=e,this.posX=t,this.posY=n,this.colour=r,this.deep=a}function t(e){var t=window.getComputedStyle(e.target,null);c=[e.target.id,parseInt(t.getPropertyValue("left"),10)-e.clientX,parseInt(t.getPropertyValue("top"),10)-e.clientY],e.dataTransfer.setData("text/plain",c)}function n(e){var t=document.getElementById(c[0]);return t.style.left=100*(e.clientX+parseInt(c[1],10))/v+"%",t.style.top=100*(e.clientY+parseInt(c[2],10))/f+"%",e.preventDefault(),!1}function r(e){var t=document.getElementById(c[0]);t.style.left=100*(e.clientX+parseInt(c[1],10))/v+"%",t.style.top=100*(e.clientY+parseInt(c[2],10))/f+"%";for(var n=0;n<m.length;n++)m[n].name==c[0]&&(m[n].posX=t.style.left,m[n].posY=t.style.top,m[n].colour=t.dataset.colour,m[n].deep=t.dataset.deep);return a(),u(),e.preventDefault(),!1}function a(){for(var e=[],t=0;t<m.length;t++)e.push("radial-gradient(circle at "+m[t].posX+" "+m[t].posY+", "+m[t].colour+", transparent "+m[t].deep+")");e.push("radial-gradient(circle at 50% 50%, #000, #000 100%)"),p.style.background=e.toString()}function i(e,t,n){for(var r=0,a=e.length;a>r;r++)if(e[r][n]===t)return r;return-1}function l(e){var t=document.getElementById(e),n=document.getElementById("r_"+e);t.parentNode.removeChild(t),n.parentNode.removeChild(n);var r=i(m,e,"name");r>-1&&m.splice(r,1),a(),console.log(m)}function s(e){e>0&&(m.move(e,e-1),o(),a()),console.log(m)}function o(){var e=document.getElementById("coords");e.innerHTML="";for(var t=m.length-1;t>=0;t--){var n=e.insertRow(0);n.setAttribute("id","r_"+m[t].name);var r=n.insertCell(0);r.setAttribute("class","c_name");var o=n.insertCell(1);o.setAttribute("class","c_posX");var u=n.insertCell(2);u.setAttribute("class","c_posY");var c=n.insertCell(3);c.setAttribute("class","c_colour");var p=n.insertCell(4);p.setAttribute("class","c_del");var v=n.insertCell(5);v.setAttribute("class","c_deep-slider");var f=n.insertCell(6);f.setAttribute("class","c_deep-value");var h=n.insertCell(7);h.setAttribute("class","c_up"),r.innerHTML=m[t].name,o.innerHTML=m[t].posX,u.innerHTML=m[t].posY,c.innerHTML=m[t].colour;var g=document.createElement("button");g.setAttribute("class","del_item"),g.setAttribute("data-del",m[t].name);var y=document.createTextNode("x");g.appendChild(y),p.appendChild(g),document.querySelector(".del_item").onclick=function(){l(this.dataset.del)};var b=document.createElement("input");b.setAttribute("id","slider_"+m[t].name),b.setAttribute("type","range"),b.setAttribute("min","1"),b.setAttribute("max","100"),b.setAttribute("value",parseInt(m[t].deep)),v.appendChild(b);var A=document.createElement("input");A.setAttribute("id","value_"+m[t].name),A.setAttribute("type","text"),A.setAttribute("size","2"),f.appendChild(A),d("slider_"+m[t].name,"value_"+m[t].name),document.querySelector("[id*=slider_]").onchange=function(){var e=this.id.replace("slider_","");d(this.id,"value_"+e),document.getElementById(e).dataset.deep=this.value+"%";var t=i(m,e,"name");t>-1&&(m[t].deep=this.value+"%"),a()};var _=document.createElement("button");_.setAttribute("class","up_item"),_.setAttribute("data-level",t);var E=document.createTextNode("^");_.appendChild(E),h.appendChild(_),document.querySelector(".up_item").onclick=function(){s(this.dataset.level)}}}function d(e,t){var n=document.getElementById(t),r=document.getElementById(e);n.value=r.value}function u(){for(var e=0;e<m.length;e++){var t=document.getElementById("r_"+m[e].name);t.querySelector(".c_name").innerHTML=m[e].name,t.querySelector(".c_posX").innerHTML=m[e].posX,t.querySelector(".c_posY").innerHTML=m[e].posY,t.querySelector(".c_colour").innerHTML=m[e].colour}}Array.prototype.move=function(e,t){for(;0>e;)e+=this.length;for(;0>t;)t+=this.length;if(t>=this.length)for(var n=t-this.length;n--+1;)this.push(void 0);return this.splice(t,0,this.splice(e,1)[0]),this};var c,p=document.getElementById("div"),m=[],v=p.offsetWidth,f=p.offsetHeight,h=document.getElementById("add_point"),g=document.getElementById("set_colour");[].forEach.call(document.querySelectorAll(".dragme"),function(n){n.addEventListener("dragstart",t,!1),m.push(new e(n.id,100*n.offsetLeft/v+"%",100*n.offsetTop/f+"%","rgba(255,255,255,.5)","50%"))}),e.prototype.getInfo=function(){return this.name+" ("+this.posX+","+this.posY+") - "+this.colour+" - "+this.deep},window.onresize=function(){v=p.offsetWidth,f=p.offsetHeight},o(),h.onclick=function(){var n=document.createElement("span");if(n.setAttribute("draggable","true"),m.length>0){var r=m[m.length-1].name;r=r.replace("d",""),newN=parseInt(r)+1}else newN=1;n.setAttribute("id","d"+newN),n.setAttribute("class","dragme");var i=""!==g.value?g.value:"blue";n.setAttribute("data-colour",i),n.setAttribute("data-deep","50%"),p.appendChild(n),n.addEventListener("dragstart",t,!1),m.push(new e(n.id,100*n.offsetLeft/v+"%",100*n.offsetTop/f+"%",i,"50%")),o(),a()},p.addEventListener("dragover",n,!1),p.addEventListener("drop",r,!1)});