document.addEventListener("DOMContentLoaded",function(){function e(e,t,n,r,o){this.name=e,this.posX=t,this.posY=n,this.colour=r,this.deep=o}function t(e){var t=window.getComputedStyle(e.target,null);d=[e.target.id,parseInt(t.getPropertyValue("left"),10)-e.clientX,parseInt(t.getPropertyValue("top"),10)-e.clientY],e.dataTransfer.setData("text/plain",d)}function n(e){var t=document.getElementById(d[0]);return t.style.left=100*(e.clientX+parseInt(d[1],10))/p+"%",t.style.top=100*(e.clientY+parseInt(d[2],10))/f+"%",e.preventDefault(),!1}function r(e){var t=document.getElementById(d[0]);t.style.left=100*(e.clientX+parseInt(d[1],10))/p+"%",t.style.top=100*(e.clientY+parseInt(d[2],10))/f+"%";for(var n=0;n<u.length;n++)u[n].name==d[0]&&(u[n].posX=t.style.left,u[n].posY=t.style.top,u[n].colour=t.dataset.colour,u[n].deep=t.dataset.deep,console.log(u[n].getInfo()));return o(),i(),e.preventDefault(),!1}function o(){for(var e=[],t=0;t<u.length;t++)e.push("radial-gradient(circle at "+u[t].posX+" "+u[t].posY+", "+u[t].colour+", transparent "+u[t].deep+")");e.push("radial-gradient(circle at 50% 50%, #000, #000 100%)"),c.style.background=e.toString()}function a(e,t,n){for(var r=0,o=e.length;o>r;r++)if(e[r][n]===t)return r;return-1}function l(e){var t=document.getElementById(e),n=document.getElementById("r_"+e);t.parentNode.removeChild(t),n.parentNode.removeChild(n);var r=a(u,e,"name");r>-1&&u.splice(r,1),o(),console.log(u)}function s(){var e=document.getElementById("coords");e.innerHTML="";for(var t=0;t<u.length;t++){var n=e.insertRow(0);n.setAttribute("id","r_"+u[t].name);var r=n.insertCell(0);r.setAttribute("class","c_name");var o=n.insertCell(1);o.setAttribute("class","c_posX");var a=n.insertCell(2);a.setAttribute("class","c_posY");var s=n.insertCell(3);s.setAttribute("class","c_colour");var i=n.insertCell(4);i.setAttribute("class","c_del"),r.innerHTML=u[t].name,o.innerHTML=u[t].posX,a.innerHTML=u[t].posY,s.innerHTML=u[t].colour;var d=document.createElement("button");d.setAttribute("class","del_item"),d.setAttribute("data-del",u[t].name),i.appendChild(d),document.querySelector(".del_item").onclick=function(){l(this.dataset.del)}}}function i(){for(var e=0;e<u.length;e++){var t=document.getElementById("r_"+u[e].name);t.querySelector(".c_name").innerHTML=u[e].name,t.querySelector(".c_posX").innerHTML=u[e].posX,t.querySelector(".c_posY").innerHTML=u[e].posY,t.querySelector(".c_colour").innerHTML=u[e].colour}}var d,c=document.getElementById("div"),u=[],p=c.offsetWidth,f=c.offsetHeight,m=document.getElementById("add_point"),g=document.getElementById("set_colour");[].forEach.call(document.querySelectorAll(".dragme"),function(n){n.addEventListener("dragstart",t,!1),u.push(new e(n.id,n.offsetLeft+"px",n.offsetTop+"px","green","100%"))}),e.prototype.getInfo=function(){return this.name+" ("+this.posX+","+this.posY+") - "+this.colour+" - "+this.deep},window.onresize=function(){p=c.offsetWidth,f=c.offsetHeight},s(),m.onclick=function(){var n=document.createElement("span");if(n.setAttribute("draggable","true"),u.length>0){var r=u[u.length-1].name;r=r.replace("d",""),newN=parseInt(r)+1}else newN=1;n.setAttribute("id","d"+newN),n.setAttribute("class","dragme");var o=""!==g.value?g.value:"blue";n.setAttribute("data-colour",o),n.setAttribute("data-deep","50%"),c.appendChild(n),n.addEventListener("dragstart",t,!1),u.push(new e(n.id,n.offsetLeft+"px",n.offsetTop+"px",o,"50%")),s()},c.addEventListener("dragover",n,!1),c.addEventListener("drop",r,!1)});