document.addEventListener("DOMContentLoaded",function(){function e(e,t,n,r,a){this.name=e,this.posX=t,this.posY=n,this.colour=r,this.deep=a}function t(e){var t=window.getComputedStyle(e.target,null);p=[e.target.id,parseInt(t.getPropertyValue("left"),10)-e.clientX,parseInt(t.getPropertyValue("top"),10)-e.clientY],e.dataTransfer.setData("text/plain",p)}function n(e){var t=document.getElementById(p[0]);return t.style.left=(100*(e.clientX+parseInt(p[1],10))/f).toFixed(2)+"%",t.style.top=(100*(e.clientY+parseInt(p[2],10))/g).toFixed(2)+"%",e.preventDefault(),!1}function r(e){var t=document.getElementById(p[0]);t.style.left=(100*(e.clientX+parseInt(p[1],10))/f).toFixed(2)+"%",t.style.top=(100*(e.clientY+parseInt(p[2],10))/g).toFixed(2)+"%";for(var n=0;n<h.length;n++)h[n].name==p[0]&&(h[n].posX=t.style.left,h[n].posY=t.style.top,h[n].colour=t.dataset.colour,h[n].deep=t.dataset.deep);return a(),u(),e.preventDefault(),!1}function a(){for(var e=[],t=0;t<h.length;t++)e.push("radial-gradient(circle at "+h[t].posX+" "+h[t].posY+", "+h[t].colour+", transparent "+h[t].deep+")");e.push("radial-gradient(circle at 50% 50%, #000, #000 100%)"),v.style.background=e.toString()}function o(e,t,n){for(var r=0,a=e.length;a>r;r++)if(e[r][n]===t)return r;return-1}function l(e){var t=document.getElementById(e),n=document.getElementById("r_"+e);t.parentNode.removeChild(t),n.parentNode.removeChild(n);var r=o(h,e,"name");r>-1&&h.splice(r,1),a(),console.log(h)}function i(e){e>0&&(h.move(e,e-1),s(),a()),console.log(h)}function s(){A.innerHTML="";for(var e=h.length-1;e>=0;e--){var t=A.insertRow(0);t.setAttribute("id","r_"+h[e].name);var n=t.insertCell(0);n.setAttribute("class","c_name");var r=t.insertCell(1);r.setAttribute("class","c_posX");var s=t.insertCell(2);s.setAttribute("class","c_posY");var u=t.insertCell(3);u.setAttribute("class","c_colour");var c=t.insertCell(4);c.setAttribute("class","c_deep-slider");var p=t.insertCell(5);p.setAttribute("class","c_deep-value");var m=t.insertCell(6);m.setAttribute("class","c_del");var v=t.insertCell(7);v.setAttribute("class","c_up"),n.innerHTML=h[e].name,r.innerHTML=h[e].posX,s.innerHTML=h[e].posY,u.innerHTML=h[e].colour;var f=document.createElement("button");f.setAttribute("class","del_item"),f.setAttribute("data-del",h[e].name);var g=document.createTextNode("del");f.appendChild(g),m.appendChild(f),document.querySelector(".del_item").onclick=function(){l(this.dataset.del)};var y=document.createElement("input");y.setAttribute("id","slider_"+h[e].name),y.setAttribute("type","range"),y.setAttribute("min","1"),y.setAttribute("max","100"),y.setAttribute("value",parseInt(h[e].deep)),c.appendChild(y);var b=document.createElement("input");b.setAttribute("id","value_"+h[e].name),b.setAttribute("type","text"),b.setAttribute("size","2"),p.appendChild(b),d("slider_"+h[e].name,"value_"+h[e].name),document.querySelector("[id*=slider_]").onchange=function(){var e=this.id.replace("slider_","");d(this.id,"value_"+e),document.getElementById(e).dataset.deep=this.value+"%";var t=o(h,e,"name");t>-1&&(h[t].deep=this.value+"%"),a()};var _=document.createElement("button");_.setAttribute("class","up_item"),_.setAttribute("data-level",e);var E=document.createTextNode("up");_.appendChild(E),v.appendChild(_),document.querySelector(".up_item").onclick=function(){i(this.dataset.level)}}}function d(e,t){var n=document.getElementById(t),r=document.getElementById(e);n.value=r.value}function u(){for(var e=0;e<h.length;e++){var t=document.getElementById("r_"+h[e].name);t.querySelector(".c_name").innerHTML=h[e].name,t.querySelector(".c_posX").innerHTML=h[e].posX,t.querySelector(".c_posY").innerHTML=h[e].posY,t.querySelector(".c_colour").innerHTML=h[e].colour}}function c(){for(var e=[],t=0;t<h.length;t++)e.push(parseInt(h[t].name.replace("d","")));return Math.max.apply(Math,e)}Array.prototype.move=function(e,t){for(;0>e;)e+=this.length;for(;0>t;)t+=this.length;if(t>=this.length)for(var n=t-this.length;n--+1;)this.push(void 0);return this.splice(t,0,this.splice(e,1)[0]),this};var p,m=function(e){var t=document.createElement("div");if(t.style.color=e,!t.style.color)return null;document.head.appendChild(t);var n=getComputedStyle(t).color;if(document.head.removeChild(t),!n)return null;n.match(/\((\d+), (\d+), (\d+)/);return n},v=document.getElementById("div"),h=[],f=v.offsetWidth,g=v.offsetHeight,y=document.getElementById("add_point"),b=document.getElementById("set_colour"),A=document.getElementById("coords");[].forEach.call(document.querySelectorAll(".dragme"),function(n){n.addEventListener("dragstart",t,!1),h.push(new e(n.id,(100*n.offsetLeft/f).toFixed(2)+"%",(100*n.offsetTop/g).toFixed(2)+"%","rgba(255,255,255,.5)","50%"))}),e.prototype.getInfo=function(){return this.name+" ("+this.posX+","+this.posY+") - "+this.colour+" - "+this.deep},window.onresize=function(){f=v.offsetWidth,g=v.offsetHeight},s(),y.onclick=function(){var n=document.createElement("span");n.setAttribute("draggable","true"),newN=h.length>0?c()+1:1,n.setAttribute("id","d"+newN),n.setAttribute("class","dragme");var r=""!==b.value&&null!==m(b.value)?b.value:"blue";n.setAttribute("data-colour",r),n.setAttribute("data-deep","50%"),v.appendChild(n),n.addEventListener("dragstart",t,!1),h.push(new e(n.id,100*n.offsetLeft/f+"%",100*n.offsetTop/g+"%",r,"50%")),s(),a()},v.addEventListener("dragover",n,!1),v.addEventListener("drop",r,!1)});