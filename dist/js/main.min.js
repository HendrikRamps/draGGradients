document.addEventListener("DOMContentLoaded",function(){function e(e,t,n,r,o){this.name=e,this.posX=t,this.posY=n,this.colour=r,this.deep=o}function t(e){var t=window.getComputedStyle(e.target,null);c=[e.target.id,parseInt(t.getPropertyValue("left"),10)-e.clientX,parseInt(t.getPropertyValue("top"),10)-e.clientY],e.dataTransfer.setData("text/plain",c)}function n(e){var t=document.getElementById(c[0]);return t.style.left=100*(e.clientX+parseInt(c[1],10))/f+"%",t.style.top=100*(e.clientY+parseInt(c[2],10))/h+"%",e.preventDefault(),!1}function r(e){var t=document.getElementById(c[0]);t.style.left=100*(e.clientX+parseInt(c[1],10))/f+"%",t.style.top=100*(e.clientY+parseInt(c[2],10))/h+"%";for(var n=0;n<v.length;n++)v[n].name==c[0]&&(v[n].posX=t.style.left,v[n].posY=t.style.top,v[n].colour=t.dataset.colour,v[n].deep=t.dataset.deep);return o(),u(),e.preventDefault(),!1}function o(){for(var e=[],t=0;t<v.length;t++)e.push("radial-gradient(circle at "+v[t].posX+" "+v[t].posY+", "+v[t].colour+", transparent "+v[t].deep+")");e.push("radial-gradient(circle at 50% 50%, #000, #000 100%)"),m.style.background=e.toString()}function a(e,t,n){for(var r=0,o=e.length;o>r;r++)if(e[r][n]===t)return r;return-1}function l(e){var t=document.getElementById(e),n=document.getElementById("r_"+e);t.parentNode.removeChild(t),n.parentNode.removeChild(n);var r=a(v,e,"name");r>-1&&v.splice(r,1),o(),console.log(v)}function i(e){e>0&&(v.move(e,e-1),s(),o()),console.log(v)}function s(){b.innerHTML="";for(var e=v.length-1;e>=0;e--){var t=b.insertRow(0);t.setAttribute("id","r_"+v[e].name);var n=t.insertCell(0);n.setAttribute("class","c_name");var r=t.insertCell(1);r.setAttribute("class","c_posX");var s=t.insertCell(2);s.setAttribute("class","c_posY");var u=t.insertCell(3);u.setAttribute("class","c_colour");var c=t.insertCell(4);c.setAttribute("class","c_del");var p=t.insertCell(5);p.setAttribute("class","c_deep-slider");var m=t.insertCell(6);m.setAttribute("class","c_deep-value");var f=t.insertCell(7);f.setAttribute("class","c_up"),n.innerHTML=v[e].name,r.innerHTML=v[e].posX,s.innerHTML=v[e].posY,u.innerHTML=v[e].colour;var h=document.createElement("button");h.setAttribute("class","del_item"),h.setAttribute("data-del",v[e].name);var g=document.createTextNode("x");h.appendChild(g),c.appendChild(h),document.querySelector(".del_item").onclick=function(){l(this.dataset.del)};var y=document.createElement("input");y.setAttribute("id","slider_"+v[e].name),y.setAttribute("type","range"),y.setAttribute("min","1"),y.setAttribute("max","100"),y.setAttribute("value",parseInt(v[e].deep)),p.appendChild(y);var A=document.createElement("input");A.setAttribute("id","value_"+v[e].name),A.setAttribute("type","text"),A.setAttribute("size","2"),m.appendChild(A),d("slider_"+v[e].name,"value_"+v[e].name),document.querySelector("[id*=slider_]").onchange=function(){var e=this.id.replace("slider_","");d(this.id,"value_"+e),document.getElementById(e).dataset.deep=this.value+"%";var t=a(v,e,"name");t>-1&&(v[t].deep=this.value+"%"),o()};var _=document.createElement("button");_.setAttribute("class","up_item"),_.setAttribute("data-level",e);var E=document.createTextNode("^");_.appendChild(E),f.appendChild(_),document.querySelector(".up_item").onclick=function(){i(this.dataset.level)}}}function d(e,t){var n=document.getElementById(t),r=document.getElementById(e);n.value=r.value}function u(){for(var e=0;e<v.length;e++){var t=document.getElementById("r_"+v[e].name);t.querySelector(".c_name").innerHTML=v[e].name,t.querySelector(".c_posX").innerHTML=v[e].posX,t.querySelector(".c_posY").innerHTML=v[e].posY,t.querySelector(".c_colour").innerHTML=v[e].colour}}Array.prototype.move=function(e,t){for(;0>e;)e+=this.length;for(;0>t;)t+=this.length;if(t>=this.length)for(var n=t-this.length;n--+1;)this.push(void 0);return this.splice(t,0,this.splice(e,1)[0]),this};var c,p=function(e){var t=document.createElement("div");if(t.style.color=e,!t.style.color)return null;document.head.appendChild(t);var n=getComputedStyle(t).color;if(document.head.removeChild(t),!n)return null;n.match(/\((\d+), (\d+), (\d+)/);return!0},m=document.getElementById("div"),v=[],f=m.offsetWidth,h=m.offsetHeight,g=document.getElementById("add_point"),y=document.getElementById("set_colour"),b=document.getElementById("coords");[].forEach.call(document.querySelectorAll(".dragme"),function(n){n.addEventListener("dragstart",t,!1),v.push(new e(n.id,(100*n.offsetLeft/f).toFixed(2)+"%",(100*n.offsetTop/h).toFixed(2)+"%","rgba(255,255,255,.5)","50%"))}),e.prototype.getInfo=function(){return this.name+" ("+this.posX+","+this.posY+") - "+this.colour+" - "+this.deep},window.onresize=function(){f=m.offsetWidth,h=m.offsetHeight},s(),g.onclick=function(){var n=document.createElement("span");n.setAttribute("draggable","true"),newN=v.length>0?v.length+1:1,n.setAttribute("id","d"+newN),n.setAttribute("class","dragme");var r=""!==y.value&&1==p(y.value)?y.value:"blue";n.setAttribute("data-colour",r),n.setAttribute("data-deep","50%"),m.appendChild(n),n.addEventListener("dragstart",t,!1),v.push(new e(n.id,100*n.offsetLeft/f+"%",100*n.offsetTop/h+"%",r,"50%")),s(),o()},m.addEventListener("dragover",n,!1),m.addEventListener("drop",r,!1)});