document.addEventListener("DOMContentLoaded",function(){function e(e,t,n,r,a){this.name=e,this.posX=t,this.posY=n,this.colour=r,this.deep=a}function t(e){var t=window.getComputedStyle(e.target,null);u=[e.target.id,parseInt(t.getPropertyValue("left"),10)-e.clientX,parseInt(t.getPropertyValue("top"),10)-e.clientY],e.dataTransfer.setData("text/plain",u)}function n(e){var t=document.getElementById(u[0]);return t.style.left=100*(e.clientX+parseInt(u[1],10))/m+"%",t.style.top=100*(e.clientY+parseInt(u[2],10))/f+"%",e.preventDefault(),!1}function r(e){var t=document.getElementById(u[0]);t.style.left=100*(e.clientX+parseInt(u[1],10))/m+"%",t.style.top=100*(e.clientY+parseInt(u[2],10))/f+"%";for(var n=0;n<p.length;n++)p[n].name==u[0]&&(p[n].posX=t.style.left,p[n].posY=t.style.top,p[n].colour=t.dataset.colour,p[n].deep=t.dataset.deep,console.log(p[n].getInfo()));return a(),d(),e.preventDefault(),!1}function a(){for(var e=[],t=0;t<p.length;t++)e.push("radial-gradient(circle at "+p[t].posX+" "+p[t].posY+", "+p[t].colour+", transparent "+p[t].deep+")");e.push("radial-gradient(circle at 50% 50%, #000, #000 100%)"),c.style.background=e.toString()}function l(e,t,n){for(var r=0,a=e.length;a>r;r++)if(e[r][n]===t)return r;return-1}function o(e){var t=document.getElementById(e),n=document.getElementById("r_"+e);t.parentNode.removeChild(t),n.parentNode.removeChild(n);var r=l(p,e,"name");r>-1&&p.splice(r,1),a(),console.log(p)}function s(){var e=document.getElementById("coords");e.innerHTML="";for(var t=0;t<p.length;t++){var n=e.insertRow(0);n.setAttribute("id","r_"+p[t].name);var r=n.insertCell(0);r.setAttribute("class","c_name");var s=n.insertCell(1);s.setAttribute("class","c_posX");var d=n.insertCell(2);d.setAttribute("class","c_posY");var u=n.insertCell(3);u.setAttribute("class","c_colour");var c=n.insertCell(4);c.setAttribute("class","c_del");var m=n.insertCell(5);m.setAttribute("class","c_deep-slider");var f=n.insertCell(6);f.setAttribute("class","c_deep-value"),r.innerHTML=p[t].name,s.innerHTML=p[t].posX,d.innerHTML=p[t].posY,u.innerHTML=p[t].colour;var v=document.createElement("button");v.setAttribute("class","del_item"),v.setAttribute("data-del",p[t].name),c.appendChild(v),document.querySelector(".del_item").onclick=function(){o(this.dataset.del)};var g=document.createElement("input");g.setAttribute("id","slider_"+p[t].name),g.setAttribute("type","range"),g.setAttribute("min","1"),g.setAttribute("max","100"),g.setAttribute("value",parseInt(p[t].deep)),m.appendChild(g);var h=document.createElement("input");h.setAttribute("id","value_"+p[t].name),h.setAttribute("type","text"),h.setAttribute("size","2"),f.appendChild(h),i("slider_"+p[t].name,"value_"+p[t].name),document.querySelector("[id*=slider_]").onchange=function(){var e=this.id.replace("slider_","");i(this.id,"value_"+e),document.getElementById(e).dataset.deep=this.value+"%";var t=l(p,e,"name");t>-1&&(p[t].deep=this.value+"%"),a()}}}function i(e,t){var n=document.getElementById(t),r=document.getElementById(e);n.value=r.value}function d(){for(var e=0;e<p.length;e++){var t=document.getElementById("r_"+p[e].name);t.querySelector(".c_name").innerHTML=p[e].name,t.querySelector(".c_posX").innerHTML=p[e].posX,t.querySelector(".c_posY").innerHTML=p[e].posY,t.querySelector(".c_colour").innerHTML=p[e].colour,t.querySelector(".c_deep").innerHTML=p[e].deep}}var u,c=document.getElementById("div"),p=[],m=c.offsetWidth,f=c.offsetHeight,v=document.getElementById("add_point"),g=document.getElementById("set_colour");[].forEach.call(document.querySelectorAll(".dragme"),function(n){n.addEventListener("dragstart",t,!1),p.push(new e(n.id,n.offsetLeft+"px",n.offsetTop+"px","green","100%"))}),e.prototype.getInfo=function(){return this.name+" ("+this.posX+","+this.posY+") - "+this.colour+" - "+this.deep},window.onresize=function(){m=c.offsetWidth,f=c.offsetHeight},s(),v.onclick=function(){var n=document.createElement("span");if(n.setAttribute("draggable","true"),p.length>0){var r=p[p.length-1].name;r=r.replace("d",""),newN=parseInt(r)+1}else newN=1;n.setAttribute("id","d"+newN),n.setAttribute("class","dragme");var a=""!==g.value?g.value:"blue";n.setAttribute("data-colour",a),n.setAttribute("data-deep","50%"),c.appendChild(n),n.addEventListener("dragstart",t,!1),p.push(new e(n.id,n.offsetLeft+"px",n.offsetTop+"px",a,"50%")),s()},c.addEventListener("dragover",n,!1),c.addEventListener("drop",r,!1)});